function InitializeCalendar(){try{$("#calendar").fullCalendar({timezone:!1,header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},buttonText:{today:"today",month:"month",week:"week",day:"day"},selectable:!0,select:function(n){ShowModal(n,null)},events:function(n,t,i,r){$.ajax({url:routeURL+"/api/Appointment/GetCalendarData",type:"GET",dataType:"JSON",success:function(n){var t=[];n.status===1&&$.each(n.dataenum,function(n,i){t.push({title:i.title,description:i.desc,start:i.start_Date,end:i.end_Date,backgroundColor:i.isClientApprove?"#28a745":"#dc3545",borderColor:"#162466",textColor:"white",id:i.sr})});r(t)}})},eventRender:function(n,t){t.qtip({content:n.description})},editable:!1,droppable:!0,nowIndicator:!0,eventClick:function(n){GetEventDetailsByEventId(n)}})}catch(n){alert(n)}}function ShowModal(n,t){if(t!=null)$("#title").val(n.title),$("#description").val(n.desc),$("#Duration").val(n.duration),$("#append").val(n.end_Date),$("#id").val(n.sr),$("#appstart").data("kendoDatePicker").value(n.start_Date),$("#clientId").val(n.clientId),selectedSlot=n.start_Date,n.clientId===n.loginId?(isConfirmMode=!0,$("#divUserList").addClass("d-none"),$("#divAvailableSlots").addClass("d-none"),$("#divSlotTime").removeClass("d-none"),$("#divUserName").removeClass("d-none"),$("#slotTime").html("Time : "+n.start_Date),$("#userName").html("Meeting with: "+n.creatorName),$("#appstart").prop("disabled","disabled"),$("#Duration").prop("disabled","disabled"),$("#title").prop("disabled","disabled"),$("#description").prop("disabled","disabled"),$("#btnSubmit").addClass("d-none"),n.isClientApprove?$("#btnConfirm").addClass("d-none"):$("#btnConfirm").removeClass("d-none")):n.isClientApprove?($("#divUserList").addClass("d-none"),$("#title").prop("disabled","disabled"),$("#description").prop("disabled","disabled"),$("#btnSubmit").addClass("d-none"),$("#clientId").prop("disabled","disabled"),$("#appstart").prop("disabled","disabled"),$("#Duration").prop("disabled","disabled"),$("#divSlotTime").removeClass("d-none"),$("#divUserName").removeClass("d-none"),$("#slotTime").html("Time : "+n.start_Date),$("#userName").html("Meeting with: "+n.clientName),$("#divAvailableSlots").addClass("d-none")):$("#btnSubmit").removeClass("d-none");else{if(n._i!==undefined){let t=n._i,i=new Date(...t);$("#appstart").data("kendoDatePicker").value(i)}else $("#appstart").data("kendoDatePicker").value(n._d);$("#id").val(0);$("#clientId").prop("disabled",!1);$("#btnSubmit").removeClass("d-none")}$(".select2").select2();$("#appointmentInput").modal("show");GetTimeSlots()}function GetEventDetailsByEventId(n){$.ajax({type:"GET",url:routeURL+"/api/Appointment/GetCalendarDataById/"+n.id,dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){n.status===1&&n.dataenum!==undefined?($("#deleteBtn").removeClass("hidden"),ShowModal(n.dataenum,!0)):$.notify(n.message,"error")}})}function CloseModal(){$("#frmapp")[0].reset();$("#id").val(0);$("#appointmentInput").modal("hide");selectedSlot=null;$("#divAvailableSlots").removeClass("d-none");$("#divSlotTime").addClass("d-none");$("#divUserName").addClass("d-none");$("#slotTime").html("");$("#userName").html("");$("#clientId").prop("disabled",!1);$("#appstart").prop("disabled",!1);$("#Duration").prop("disabled",!1);$("#btnSubmit").removeClass("d-none");$("#divUserList").removeClass("d-none");$("#title").prop("disabled",!1);$("#description").prop("disabled",!1);$("#btnConfirm").addClass("d-none");isConfirmMode=!1}function SubmitForm(){if(Validation()){if(!isConfirmMode&&(selectedSlot=$("input[name='slotGroup']:checked").val(),selectedSlot===undefined||selectedSlot===null))return alert("Please select time slot"),!1;var n={Sr:parseInt($("#id").val()),Title:$("#title").val(),Desc:$("#description").val(),Start_Date:selectedSlot,Duration:$("#Duration").val(),ClientId:$("#clientId").val()};$.ajax({url:routeURL+"/api/Appointment/SaveCalendarData",type:"POST",data:JSON.stringify(n),contentType:"application/json",success:function(n){n.status===1?($("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("refetchEvents"),$.notify(n.message,"success"),CloseModal()):$.notify(n.message,"error")},error:function(){$.notify("Error","error")}})}}function DeleteAppoinment(){var n=parseInt($("#id").val());$.ajax({type:"GET",url:routeURL+"/api/Appointment/DeleteAppoinment/"+n,dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){n.status===1?($.notify(n.message,"success"),$("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("refetchEvents"),CloseModal()):$.notify(n.message,"error")}})}function Validation(){let n=!0;return $("#title").val()===undefined||$("#title").val().trim()===""?(n=!1,$("#title").addClass("error")):$("#title").removeClass("error"),$("#appstart").val()===""||$("#appstart").val()===undefined?(n=!1,$("#appstart").addClass("error")):$("#appstart").removeClass("error"),n}function GetUserList(){$.ajax({url:routeURL+"/api/Appointment/GetUser",type:"GET",dataType:"JSON",success:function(n){if(n.status===1){var t="";$.each(n.dataenum,function(n,i){t+='<option value="'+i.id+'">'+i.name+"<\/option>"});$("#clientId").html(t)}}})}function GetTimeSlots(){var n={ClientId:$("#clientId").val(),EventDate:$("#appstart").val(),Duration:$("#Duration").val(),AppointmentId:parseInt($("#id").val())};$.ajax({url:routeURL+"/api/Appointment/GetTimeSlots",type:"POST",data:JSON.stringify(n),contentType:"application/json",success:function(n){if(n.status===1&&n.dataenum.length>0){var t=bindSlots(n.dataenum);$("#divSlots").html(t)}else $("#divSlots").html('<div class="col-sm-12">No any slots are available <\/div>')}})}function bindSlots(n){for(var t="",i=0;i<n.length;i++)t+='<div class="col-sm-3">',t+='<label class="radio-container">',t+=selectedSlot===n[i].timeSlotDate?'<input type="radio" name="slotGroup" value="'+n[i].timeSlotDate+'" checked="checked">':'<input type="radio" name="slotGroup" value="'+n[i].timeSlotDate+'">',t+='<span class="checkmark">'+n[i].timeSlot+"<\/span>",t+="<\/div>";return t}function OnConfirm(){$.ajax({type:"GET",url:routeURL+"/api/Appointment/ConfirmEvent/"+parseInt($("#id").val()),dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){n.status===1?($.notify(n.message,"success"),$("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("refetchEvents"),CloseModal()):$.notify(n.message,"error")}})}var routeURL=location.protocol+"//"+location.host,selectedSlot=null,isConfirmMode=!1;$(document).ready(function(){GetUserList();$("#appstart").kendoDatePicker({dateInput:!0,change:GetTimeSlots});InitializeCalendar();$("#appointmentInput").on("hidden.bs.modal",function(){$("#title").removeClass("error");$("#appstart").removeClass("error");$("#deleteBtn").addClass("hidden")})});